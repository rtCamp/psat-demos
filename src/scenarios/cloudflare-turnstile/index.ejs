<%- include(commonPath + '/header.ejs') %>

<%- include(commonPath + '/internal-page/header.ejs', {containerType: 'sm'}) %>
    <div id="status-message" class="text-center font-bold text-lg my-4"></div>  
    <form action="?" method="POST" id="captcha-form" class="flex justify-between">
        <div id="recaptcha-container"></div>
        <input 
            type="submit" 
            value="Log in" 
            disabled
            class="px-4 py-2 bg-gray-100 text-white rounded transition duration-300 cursor-not-allowed" />
    </form>
<%- include(commonPath + '/internal-page/footer.ejs') %>
<script type="text/javascript">
    const statusMessage = document.getElementById('status-message');
    const captchaForm = document.getElementById('captcha-form');
    const sendButton = captchaForm.querySelector('input[type="submit"]')

    const verifyCallback = (response) => {
        if (response) {
            statusMessage.textContent = `captcha verified`;
            sendButton.removeAttribute('disabled');
            sendButton.classList.remove('cursor-not-allowed');
            sendButton.classList.remove('bg-gray-100');
            sendButton.classList.add('bg-blue-500');
        }
    };

    const errorCallback = (error) => {
        if (error) {
            statusMessage.textContent = `captcha error`;
        }
    };

    window.onloadTurnstileCallback = function () {
        turnstile.render('#recaptcha-container', {
            sitekey: '<%= turnstileSiteKey %>',
            callback: verifyCallback,
            'error-callback': errorCallback
        });
    };
</script>
<script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback" defer></script>
<%- include(commonPath + '/footer.ejs') %>
