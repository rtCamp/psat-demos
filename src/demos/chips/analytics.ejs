(
	function ( window ) {
		// Track user interactions
		function trackInteraction( interaction ) {
			// Determine the remote URL based on the type of interaction
			const baseURL = '<%= protocol %>://<%= domainC %><% if (isPortPresent) { %>:<%= port %><% } %>';
			const remoteURL = interaction === 'buttonClickedCHIPS' ? `${baseURL}/chips/trackCHIPS` : `${baseURL}/chips/track`;

			// Send the interaction data to the remote URL
			fetch( remoteURL, {
				method: 'POST',
				credentials: 'include',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify( {interaction: interaction} )
			} ).then( function ( response ) {
				// Check if the response was successful
				if ( !response.ok ) {
					throw new Error( 'Network response was not ok' );
				}
				
				// Return the response text
				return response.text();
			} ).then( function ( data ) {
				// Get the status div
				let statusDiv = document.getElementById( 'status' );

				// If the status div exists, update its text and color
				if ( statusDiv ) {
					statusDiv.textContent = 'Interaction tracked!';
					statusDiv.style.color = 'green';
				}
			} ).catch( function ( error ) {
				// Get the status div
				let statusDiv = document.getElementById( 'status' );

				// If the status div exists, update its text and color
				if ( statusDiv ) {
					statusDiv.textContent = 'Interaction could not be tracked.';
					statusDiv.style.color = 'red';
				}
			} );
		}

		// Expose the trackInteraction function globally
		window.trackInteraction = trackInteraction;
	}
)( window );
